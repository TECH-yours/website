function ajax(method, url, data, callback) {
    const token = localStorage.getItem('token');
    $.ajax({
        type: method,
        url: url,
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify(data),
        headers: {"Authorization": "Bearer " + getCookie("Authorization")},
        success: function (res) {
            callback(res);
        }, error: function (err) {
            callback(err.responseJSON);
        },
        statusCode: {
            403: function(xhr) {
                $.growl.error({message: '未授權此頁面'});
                setTimeout(() => {
                    window.location.href = '/';
                }, 1500);
            }
        }
    });
}

function ajax_form(method, url, form, callback)
{
    $.ajax({
        type: method,
        url: host + url + '&scid=1',
        data: form.serialize(), // serializes the form's elements.
        success: function(res)
        {
            callback(res);
        }
    });
}

function isEmail(email) {
    var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
    return regex.test(email);
}

function viewPassword(input) {
    const type = $('#' + input).attr("type");
    $('#' + input).attr("type", (type == "password") ? "text" : "password");
    $('#icon-' + input).attr("src", "/frontend/img/login/" + ((type == "password") ? "icon-eye-slash.svg" : "icon-eye.svg"))
}

function getCookie(cname) {
    let name = cname + "=";
    let decodedCookie = decodeURIComponent(document.cookie);
    let ca = decodedCookie.split(';');
    for(let i = 0; i <ca.length; i++) {
      let c = ca[i];
      while (c.charAt(0) == ' ') {
        c = c.substring(1);
      }
      if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
      }
    }
    return "";
}

function logout()
{
    // console.log("logout");
    document.cookie = "Authorization=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
    window.location.href = "/";
}

$(document).ready(function(){
});
